<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SurvivalQuant</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }
        
        .section {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
        }
        
        .chart-section {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin: 0;
        }
        
        .chart-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .control-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .control-btn:hover {
            background: #e9ecef;
        }
        
        .control-btn.active:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }
        
        .chart-container {
            position: relative;
            height: 450px;
            width: 100%;
            background: #ffffff;
            border: 3px solid #007bff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 20px rgba(0, 123, 255, 0.2);
        }
        
        #realChart {
            width: 100% !important;
            height: 400px !important;
            background: #ffffff;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .stat-item.positive {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }
        
        .stat-item.negative {
            border-left-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }
        
        .stat-change {
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .positive .stat-change {
            color: #28a745;
        }
        
        .negative .stat-change {
            color: #dc3545;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.1rem;
            color: #666;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .loading::after {
            content: '...';
            animation: pulse 1.5s infinite;
        }
        
        .links-section {
            grid-column: 1;
        }
        
        .ads-section {
            background: #f8f9fa;
            min-height: 200px;
            border-style: dashed;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
        }
        
        .future-section {
            background: #f1f3f4;
            min-height: 150px;
            border-style: dashed;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
        }
        
        @media (min-width: 768px) {
            .main-container {
                grid-template-columns: 2fr 1fr;
                grid-template-areas: 
                    "header header"
                    "chart chart"
                    "links ads"
                    "games utilities";
            }
            
            .header-section { grid-area: header; }
            .chart-section { grid-area: chart; }
            .links-section { grid-area: links; }
            .ads-section { grid-area: ads; }
            .games-section { grid-area: games; }
            .utilities-section { grid-area: utilities; }
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: 400;
        }
        
        h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 400;
            color: #333;
        }
        
        h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 500;
            color: #555;
        }
        
        .url-display {
            background: #f8f9fa;
            color: #333;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 500;
            margin: 15px 0;
            word-break: break-all;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .url-display:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .copy-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-top: 15px;
        }
        
        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
        }
        
        .description {
            margin-top: 20px;
            font-size: 1rem;
            opacity: 0.9;
            line-height: 1.6;
        }
        
        .success-message {
            display: none;
            color: #2ecc71;
            font-weight: 500;
            margin-top: 10px;
        }
        
        .link-display {
            background: #f8f9fa;
            color: #333;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .link-display a {
            color: #0066cc;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .link-display a:hover {
            color: #004499;
            text-decoration: underline;
        }
        
        .section-link {
            display: block;
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
            position: relative;
            height: 100%;
            width: 100%;
        }
        
        .section-link:hover {
            transform: translateY(-2px);
            color: #333;
        }
        
        .link-arrow {
            position: absolute;
            bottom: 15px;
            right: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .section-link:hover .link-arrow {
            opacity: 1;
            transform: translateX(5px);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Ìó§Îçî ÏÑπÏÖò -->
        <div class="section header-section">
            <h1>üöÄ SurvivalQuant</h1>
            <p>EconomicEden - Ïã§ÏãúÍ∞Ñ ÏΩîÏù∏ Ï∞®Ìä∏ Î∞è Ìà¨Ïûê ÎèÑÍµ¨</p>
        </div>
        
        <!-- Î∞îÏù¥ÎÇ∏Ïä§ Ïã§ÏãúÍ∞Ñ Ï∞®Ìä∏ ÏÑπÏÖò -->
        <div class="chart-section">
            <div class="chart-header">
                <h2 class="chart-title">üìä Î∞îÏù¥ÎÇ∏Ïä§ Ïã§ÏãúÍ∞Ñ ÏΩîÏù∏ Ï∞®Ìä∏</h2>
                <div class="chart-controls">
                    <button class="control-btn active" id="changeBtn" onclick="switchMode('change')">Î≥ÄÌôîÏú® (%)</button>
                    <button class="control-btn" id="priceBtn" onclick="switchMode('price')">Ïã§Ï†ú Í∞ÄÍ≤©</button>
                    <button class="control-btn" id="resetBtn" onclick="resetChart()">Ï∞®Ìä∏ Î¶¨ÏÖã</button>
                </div>
            </div>
            
            <!-- Ï∞®Ìä∏ ÌëúÏãú Í≥µÍ∞Ñ -->
            <div class="chart-container">
                <canvas id="realChart"></canvas>
                <div id="loadingMessage" class="loading">Î∞îÏù¥ÎÇ∏Ïä§ APIÏóêÏÑú ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ Î°úÎî©Ï§ë</div>
            </div>
            
            <div class="stats-container" id="statsContainer">
                <!-- ÌÜµÍ≥Ñ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
            </div>
        </div>
        
        <!-- ÎßÅÌÅ¨ ÏÑπÏÖò -->
        <div class="section links-section">
            <h2>üîó Ï£ºÏöî ÎßÅÌÅ¨</h2>
            
            <div class="url-display" id="urlDisplay">
                https://dgpark0617.github.io/SurvivalQuant/
            </div>
            <button class="copy-btn" onclick="copyToClipboard()">
                üìã URL Î≥µÏÇ¨ÌïòÍ∏∞
            </button>
            <div class="success-message" id="successMessage">
                ‚úÖ URLÏù¥ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!
            </div>
            
            <div class="link-display">
                <a href="https://www.bybit.com/copyMt5/trade-center/detail?providerMark=xkc2wsLqVomphpP%2FtV6RRQ%3D%3D" target="_blank">
                    üåü EconomicEden
                </a>
            </div>
            
            <div class="link-display">
                <a href="https://m.blog.naver.com/economic_eden?tab=1" target="_blank">
                    üìñ Í∞úÎ∞úÎ∏îÎ°úÍ∑∏
                </a>
            </div>
            
            <div class="link-display">
                <a href="https://youtube.com/@economiceden?si=OLHH8h2MZep0oAYA" target="_blank">
                    üì∫ Ïú†ÌäúÎ∏å
                </a>
            </div>
            
            <div class="link-display">
                <a href="https://cryptoinvest.cafe24.com:8080/m/dashboard" target="_blank">
                    üí∞ ÌÅ¨Î¶ΩÌÜ† ÎåÄÏãúÎ≥¥Îìú
                </a>
            </div>
        </div>
        
        <!-- Í¥ëÍ≥† ÏÑπÏÖò -->
        <div class="section ads-section">
            <div>
                <h3>üì∫ Í¥ëÍ≥† Í≥µÍ∞Ñ</h3>
                <p>YouTube Ïï†ÎìúÏÑºÏä§ Î∞è Í¥ëÍ≥†Í∞Ä ÌëúÏãúÎê† ÏòàÏ†ïÏûÖÎãàÎã§</p>
            </div>
        </div>
        
        <!-- Í≤åÏûÑ ÏÑπÏÖò -->
        <div class="section future-section games-section">
            <a href="games/" class="section-link">
                <h3>üéÆ ÎØ∏Îãà Í≤åÏûÑ</h3>
                <p>Ïû¨ÎØ∏ÏûàÎäî Í≤åÏûÑÎì§ÏùÑ Ï¶êÍ≤®Î≥¥ÏÑ∏Ïöî!</p>
                <div class="link-arrow">‚Üí</div>
            </a>
        </div>
        
        <!-- Ïú†Ìã∏Î¶¨Ìã∞ ÏÑπÏÖò -->
        <div class="section future-section utilities-section">
            <a href="utilities/" class="section-link">
                <h3>üõ†Ô∏è Ïú†Ìã∏Î¶¨Ìã∞</h3>
                <p>Ïú†Ïö©Ìïú ÎèÑÍµ¨Îì§ÏùÑ ÏÇ¨Ïö©Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                <div class="link-arrow">‚Üí</div>
            </a>
        </div>
    </div>

    <script>
        // Í∏∞Ï°¥ URL Î≥µÏÇ¨ Í∏∞Îä•
        function copyToClipboard() {
            const urlText = document.getElementById('urlDisplay').textContent;
            navigator.clipboard.writeText(urlText).then(function() {
                const successMessage = document.getElementById('successMessage');
                successMessage.style.display = 'block';
                setTimeout(() => {
                    successMessage.style.display = 'none';
                }, 3000);
            });
        }
        
        // Ï∞®Ìä∏ Í¥ÄÎ†® Î≥ÄÏàòÎì§
        let cryptoChart = null;
        let displayMode = 'change'; // 'change' or 'price'
        let coinData = new Map(); // Í∞Å ÏΩîÏù∏Ïùò Í∞ÄÍ≤© Îç∞Ïù¥ÌÑ∞ÏôÄ Í∏∞Ï§ÄÍ∞ÄÍ≤© Ï†ÄÏû•
        let basePrices = new Map(); // ÏµúÏ¥à ÏàòÏßë ÏãúÏ†êÏùò Í∏∞Ï§ÄÍ∞ÄÍ≤©
        let isFirstCollection = true; // ÏµúÏ¥à ÏàòÏßë Ïó¨Î∂Ä
        
        // Î∞îÏù¥ÎÇ∏Ïä§ Ïã§ÏãúÍ∞Ñ Ï∞®Ìä∏ Ï¥àÍ∏∞Ìôî
        function initializeCryptoChart() {
            console.log('=== Î∞îÏù¥ÎÇ∏Ïä§ Ïã§ÏãúÍ∞Ñ Ï∞®Ìä∏ ÏãúÏûë ===');
            
            const canvas = document.getElementById('realChart');
            const ctx = canvas.getContext('2d');
            
            // Chart.jsÎ•º ÏÇ¨Ïö©Ìïú Ïã§ÏãúÍ∞Ñ Ï∞®Ìä∏ ÏÉùÏÑ±
            cryptoChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: 'BTC (ÎπÑÌä∏ÏΩîÏù∏)',
                            data: [],
                            borderColor: '#000000',
                            backgroundColor: 'rgba(0, 0, 0, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#000000'
                        },
                        {
                            label: 'ETH (Ïù¥ÎçîÎ¶¨ÏõÄ)',
                            data: [],
                            borderColor: '#627EEA',
                            backgroundColor: 'rgba(98, 126, 234, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#627EEA'
                        },
                        {
                            label: 'XRP (Î¶¨Ìîå)',
                            data: [],
                            borderColor: '#23292F',
                            backgroundColor: 'rgba(35, 41, 47, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#23292F'
                        },
                        {
                            label: 'ADA (ÏóêÏù¥Îã§)',
                            data: [],
                            borderColor: '#0033AD',
                            backgroundColor: 'rgba(0, 51, 173, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#0033AD'
                        },
                        {
                            label: 'SOL (ÏÜîÎùºÎÇò)',
                            data: [],
                            borderColor: '#9945FF',
                            backgroundColor: 'rgba(153, 69, 255, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#9945FF'
                        },
                        {
                            label: 'DOGE (ÎèÑÏßÄÏΩîÏù∏)',
                            data: [],
                            borderColor: '#C2A633',
                            backgroundColor: 'rgba(194, 166, 51, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#C2A633'
                        },
                        {
                            label: 'AVAX (ÏïÑÎ∞úÎûÄÏ≤¥)',
                            data: [],
                            borderColor: '#E84142',
                            backgroundColor: 'rgba(232, 65, 66, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#E84142'
                        },
                        {
                            label: 'MATIC (Ìè¥Î¶¨Í≥§)',
                            data: [],
                            borderColor: '#8247E5',
                            backgroundColor: 'rgba(130, 71, 229, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#8247E5'
                        },
                        {
                            label: 'DOT (Ìè¥Ïπ¥Îã∑)',
                            data: [],
                            borderColor: '#E6007A',
                            backgroundColor: 'rgba(230, 0, 122, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#E6007A'
                        },
                        {
                            label: 'LINK (Ï≤¥Ïù∏ÎßÅÌÅ¨)',
                            data: [],
                            borderColor: '#375BD2',
                            backgroundColor: 'rgba(55, 91, 210, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#375BD2'
                        },
                        {
                            label: 'UNI (Ïú†ÎãàÏä§Ïôë)',
                            data: [],
                            borderColor: '#FF007A',
                            backgroundColor: 'rgba(255, 0, 122, 0.05)',
                            borderWidth: 1,
                            fill: false,
                            tension: 0.1,
                            pointRadius: 2,
                            pointBackgroundColor: '#FF007A'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                font: { size: 12, weight: 'bold' }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'ÏãúÍ∞Ñ (Ïãú:Î∂Ñ:Ï¥à)',
                                font: { size: 12, weight: 'bold' }
                            },
                            grid: { 
                                display: true, 
                                color: 'rgba(0,0,0,0.1)',
                                backgroundColor: '#ffffff'
                            },
                            ticks: {
                                maxRotation: 90,
                                minRotation: 90
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Î≥ÄÌôîÏú® (%)',
                                font: { size: 12, weight: 'bold' }
                            },
                            grid: { 
                                display: true, 
                                color: 'rgba(0,0,0,0.1)',
                                backgroundColor: '#ffffff'
                            },
                            min: -5,
                            max: 5,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
            
            console.log('‚úÖ Î∞îÏù¥ÎÇ∏Ïä§ Ï∞®Ìä∏ ÏÉùÏÑ± ÏÑ±Í≥µ!');
            
            // Î∞îÏù¥ÎÇ∏Ïä§ API Ïó∞Í≤∞
            connectToBinanceAPI(cryptoChart);
        }
        
        // Î∞îÏù¥ÎÇ∏Ïä§ API Ïó∞Í≤∞
        async function connectToBinanceAPI(chart) {
            console.log('üîÑ Î∞îÏù¥ÎÇ∏Ïä§ API Ïó∞Í≤∞ ÏãúÎèÑ...');
            
            try {
                // Ï£ºÏöî USDT ÏΩîÏù∏Îì§
                const targetSymbols = ['BTCUSDT', 'ETHUSDT', 'XRPUSDT', 'ADAUSDT', 'SOLUSDT', 'DOGEUSDT', 'AVAXUSDT', 'MATICUSDT', 'DOTUSDT', 'LINKUSDT', 'UNIUSDT'];
                
                console.log('üéØ ÌÉÄÍ≤ü ÏΩîÏù∏:', targetSymbols);
                
                // Ï≤´ Î≤àÏß∏ Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏ Ï∂îÍ∞Ä
                await addBinanceDataPoint(chart, targetSymbols);
                
                // Î°úÎî© Î©îÏãúÏßÄ Ïà®Í∏∞Í∏∞
                document.getElementById('loadingMessage').style.display = 'none';
                
                // 5Ï¥àÎßàÎã§ ÏóÖÎç∞Ïù¥Ìä∏
                setInterval(async () => {
                    await addBinanceDataPoint(chart, targetSymbols);
                }, 5000);
                
            } catch (error) {
                console.error('‚ùå Î∞îÏù¥ÎÇ∏Ïä§ API Ïó∞Í≤∞ Ïã§Ìå®:', error);
                
                // ÏóêÎü¨ Î©îÏãúÏßÄ ÌëúÏãú
                document.getElementById('loadingMessage').innerHTML = `
                    <div style="text-align: center; color: #ff4757;">
                        ‚ùå Î∞îÏù¥ÎÇ∏Ïä§ API Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§<br>
                        <small style="color: #666; font-size: 0.9rem;">ÏóêÎü¨: ${error.message}</small>
                    </div>
                `;
            }
        }
        
        // Î∞îÏù¥ÎÇ∏Ïä§ Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏ Ï∂îÍ∞Ä
        async function addBinanceDataPoint(chart, symbols) {
            try {
                // Î∞îÏù¥ÎÇ∏Ïä§ 24ÏãúÍ∞Ñ Ìã∞Ïª§ API Ìò∏Ï∂ú
                const symbolParam = symbols.map(s => `"${s}"`).join(',');
                const response = await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbols=[${symbolParam}]`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('üí∞ Î∞îÏù¥ÎÇ∏Ïä§ Îç∞Ïù¥ÌÑ∞ ÏàòÏã†:', data.length, 'Í∞ú ÏΩîÏù∏');
                
                // ÌòÑÏû¨ ÏãúÍ∞Ñ ÎùºÎ≤®
                const now = new Date();
                const timeLabel = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
                
                chart.data.labels.push(timeLabel);
                
                // Í∞Å ÏΩîÏù∏Ïùò Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
                for (let i = 0; i < Math.min(11, data.length); i++) {
                    const currentPrice = parseFloat(data[i].lastPrice);
                    const symbol = data[i].symbol;
                    
                    // ÏµúÏ¥à ÏàòÏßëÏù∏ Í≤ΩÏö∞ Í∏∞Ï§ÄÍ∞ÄÍ≤© ÏÑ§Ï†ï (Î≥ÄÌôîÏú® 0ÏúºÎ°ú ÏãúÏûë)
                    if (isFirstCollection) {
                        basePrices.set(symbol, currentPrice);
                        coinData.set(symbol, {
                            prices: [currentPrice],
                            changes: [0] // ÏµúÏ¥àÎäî 0%Î°ú ÏãúÏûë
                        });
                        
                        // Ï∞®Ìä∏Ïóê 0 Ï∂îÍ∞Ä (ÏµúÏ¥à ÏãúÏ†ê)
                        const valueToAdd = displayMode === 'change' ? 0 : currentPrice;
                        chart.data.datasets[i].data.push(valueToAdd);
                        
                        console.log(`${symbol}: Í∏∞Ï§ÄÍ∞ÄÍ≤© ÏÑ§Ï†ï $${currentPrice.toFixed(4)}`);
                    } else {
                        // Ïù¥ÌõÑ ÏàòÏßëÏóêÏÑúÎäî Í∏∞Ï§ÄÍ∞ÄÍ≤© ÎåÄÎπÑ Î≥ÄÌôîÏú® Í≥ÑÏÇ∞
                        const basePrice = basePrices.get(symbol);
                        const changePercent = ((currentPrice - basePrice) / basePrice) * 100;
                        
                        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                        const coinInfo = coinData.get(symbol);
                        coinInfo.prices.push(currentPrice);
                        coinInfo.changes.push(changePercent);
                        
                        // Ï∞®Ìä∏Ïóê ÌòÑÏû¨ Î™®ÎìúÏóê Îî∞Î•∏ Í∞í Ï∂îÍ∞Ä
                        const valueToAdd = displayMode === 'change' ? changePercent : currentPrice;
                        chart.data.datasets[i].data.push(valueToAdd);
                        
                        console.log(`${symbol}: $${currentPrice.toFixed(4)} (${changePercent.toFixed(3)}%)`);
                    }
                }
                
                // ÏµúÏ¥à ÏàòÏßë ÏôÑÎ£å ÌëúÏãú
                if (isFirstCollection) {
                    isFirstCollection = false;
                    console.log('‚úÖ ÏµúÏ¥à ÏàòÏßë ÏôÑÎ£å - Í∏∞Ï§ÄÍ∞ÄÍ≤© ÏÑ§Ï†ïÎê®');
                }
                
                // 50Í∞ú Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏ Ïú†ÏßÄ
                if (chart.data.labels.length > 50) {
                    chart.data.labels.shift();
                    chart.data.datasets.forEach(dataset => dataset.data.shift());
                    
                    // Îç∞Ïù¥ÌÑ∞ÎèÑ 50Í∞úÎ°ú Ï†úÌïú
                    coinData.forEach(coinInfo => {
                        if (coinInfo.prices.length > 50) {
                            coinInfo.prices.shift();
                            coinInfo.changes.shift();
                        }
                    });
                }
                
                chart.update('none');
                
                console.log(`üìä ${timeLabel} Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`);
                
            } catch (error) {
                console.error('‚ùå Î∞îÏù¥ÎÇ∏Ïä§ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', error);
            }
        }
        
        // Î™®Îìú Ï†ÑÌôò (Î≥ÄÌôîÏú®/Í∞ÄÍ≤©)
        function switchMode(mode) {
            console.log(`üîÑ Î™®Îìú Ï†ÑÌôò: ${displayMode} ‚Üí ${mode}`);
            displayMode = mode;
            
            // Î≤ÑÌäº ÌôúÏÑ±Ìôî ÏÉÅÌÉú Î≥ÄÍ≤Ω
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(mode + 'Btn').classList.add('active');
            
            if (cryptoChart && coinData.size > 0) {
                // Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞Î•º ÌòÑÏû¨ Î™®ÎìúÏóê ÎßûÍ≤å ÏóÖÎç∞Ïù¥Ìä∏
                updateChartForMode();
                
                // YÏ∂ï ÏÑ§Ï†ï Î≥ÄÍ≤Ω
                cryptoChart.options.scales.y.title.text = 
                    displayMode === 'change' ? 'Î≥ÄÌôîÏú® (%)' : 'Í∞ÄÍ≤© ($)';
                    
                if (displayMode === 'price') {
                    cryptoChart.options.scales.y.min = undefined;
                    cryptoChart.options.scales.y.max = undefined;
                } else {
                    cryptoChart.options.scales.y.min = -5;
                    cryptoChart.options.scales.y.max = 5;
                }
                
                cryptoChart.update();
                console.log(`‚úÖ Î™®Îìú Ï†ÑÌôò ÏôÑÎ£å: ${mode}`);
            }
        }
        
        // ÌòÑÏû¨ Î™®ÎìúÏóê ÎßûÍ≤å Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateChartForMode() {
            const symbols = ['BTCUSDT', 'ETHUSDT', 'XRPUSDT', 'ADAUSDT', 'SOLUSDT', 'DOGEUSDT', 'AVAXUSDT', 'MATICUSDT', 'DOTUSDT', 'LINKUSDT', 'UNIUSDT'];
            
            symbols.forEach((symbol, index) => {
                const coinInfo = coinData.get(symbol);
                if (coinInfo && cryptoChart.data.datasets[index]) {
                    // ÌòÑÏû¨ Î™®ÎìúÏóê Îî∞Îùº Îç∞Ïù¥ÌÑ∞ ÍµêÏ≤¥
                    const dataToShow = displayMode === 'change' ? coinInfo.changes : coinInfo.prices;
                    cryptoChart.data.datasets[index].data = [...dataToShow];
                }
            });
        }
        
        // Ï∞®Ìä∏ Î¶¨ÏÖã
        function resetChart() {
            console.log('üîÑ Ï∞®Ìä∏ Î¶¨ÏÖã ÏãúÏûë');
            
            if (cryptoChart) {
                // Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
                cryptoChart.data.labels = [];
                cryptoChart.data.datasets.forEach(dataset => {
                    dataset.data = [];
                });
                cryptoChart.update();
                
                // Î≥ÄÏàò Ï¥àÍ∏∞Ìôî
                coinData.clear();
                basePrices.clear();
                isFirstCollection = true;
                
                console.log('üìä Ï∞®Ìä∏ Î¶¨ÏÖã ÏôÑÎ£å - Îã§Ïùå ÏàòÏßëÎ∂ÄÌÑ∞ ÏÉàÎ°úÏö¥ Í∏∞Ï§ÄÍ∞ÄÍ≤© Ï†ÅÏö©');
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï∞®Ìä∏ Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            initializeCryptoChart();
        });
    </script>
</body>
</html>